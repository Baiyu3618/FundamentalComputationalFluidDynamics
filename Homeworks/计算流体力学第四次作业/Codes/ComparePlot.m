%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Compare different numerical method in  Weight residual method
%%%% ComparePlot.m
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% define silutions
x = 0:0.0001:1;                                                              % x span
u = sin(x) / sin(0.1e1) - x;                                               % exact solution
u1 = x .* (1 - x) .* (0.9e1 / 0.52e2 .* x + 0.81e2 / 0.416e3);             % Collocation method 
u2 = x .* (1 - x) .* (0.97e2 / 0.517e3 .* x + 0.8e1 / 0.47e2);             % Sub-domain method
u3 = x .* (1 - x) .* (0.122e3 / 0.649e3 .* x + 0.10e2 / 0.59e2);           % Moment method
u4 = x .* (1 - x) .* (0.46161e5 / 0.246137e6 .* x + 0.413e3 / 0.2437e4);   % Least-Square method
%%%% Galerkin method
u5_1 = x .* (1 - x) .* (0.71e2 / 0.369e3 .* x + 0.7e1 / 0.41e2);               % Galerkin method n = 1
u5_2 = 0.13811e5 / 0.73554e5 .* x .* (1 - x) ...
    + 0.2380e4 / 0.12259e5 .* (x .^ 2) .* (1 - x) ...
    - 0.7e1 ./ 0.299e3 .* (x .^ 3) .* (1 - x);                                 % Galerkin method n = 2
u5_3 = 0.1297898e7 / 0.6889857e7 .* x .* (1 - x) ...
    + 0.433198e6 / 0.2296619e7 .* (x .^ 2) .* (1 - x) ...
    - 0.24166e5 / 0.2296619e7 .* (x .^ 3) .* (1 - x) ...
    - 0.66e2 / 0.7681e4 .* (x .^ 4) .* (1 - x);                                % Galerkin method n = 3
u5_5 = 0.4855505939e10 / 0.25772989853e11 .* x .* (1 - x) ...
    + 0.179652917103e12 / 0.953600624561e12 .* (x .^ 2) .* (1 - x) ...
    - 0.9215765647e10 / 0.953600624561e12 .* (x .^ 3) .* (1 - x) ...
    - 0.711074859e9 / 0.73353894197e11 .* (x .^ 4) .* (1 - x) ...
    + 0.19857871e8 / 0.73353894197e11 .* (x .^ 5) .* (1 - x) ...
    + 0.715e3 / 0.3484249e7 .* (x .^ 6) .* (1 - x);                            % Galerkin method n = 5
u5_8 = 0.208717473071293077697e21 / 0.1107870993821738695378e22 .* x .* (1 - x) ...
    + 0.104358736487829639686e21 / 0.553935496910869347689e21 .* (x .^ 2) .* (1 - x) ...
    - 0.5356968223189241971e19 / 0.553935496910869347689e21 .* (x .^ 3) .* (1 - x) ...
    - 0.5356975731217602622e19 / 0.553935496910869347689e21 .* (x .^ 4) .* (1 - x) ...
    + 0.128846497216457618e18 / 0.553935496910869347689e21 .* (x .^ 5) .* (1 - x) ...
    + 0.128735032759060598e18 / 0.553935496910869347689e21 .* (x .^ 6) .* (1 - x) ...
    - 0.1665029382828760e16 / 0.553935496910869347689e21 .* (x .^ 7) .* (1 - x) ...
    - 0.1927385453158594e16 / 0.553935496910869347689e21 .* (x .^ 8) .* (1 - x) ...
    + 0.29393e5 / 0.188326235369e12 .* (x .^ 9) .* (1 - x);                    % Galerkin method n = 8
u5_10 = 0.473318025411088405849982575e27 / 0.2512369010098021442164037778e28 .* x .* (1 - x) ...
    + 0.78886337568541222320989550e26 / 0.418728168349670240360672963e27 .* (x .^ 2) .* (1 - x) ...
    - 0.4049413418504244445476000e25 / 0.418728168349670240360672963e27 .* (x .^ 3) .* (1 - x) ...
    - 0.4049413409968467808755370e25 / 0.418728168349670240360672963e27 .* (x .^ 4) .* (1 - x) ...
    + 0.97374077719537371307310e23 / 0.418728168349670240360672963e27 .* (x .^ 5) .* (1 - x) ...
    + 0.97374358060800676432002e23 / 0.418728168349670240360672963e27 .* (x .^ 6) .* (1 - x) ...
    - 0.1359523407693545994408e22 / 0.418728168349670240360672963e27 .* (x .^ 7) .* (1 - x) ...
    - 0.1357794784581134597558e22 / 0.418728168349670240360672963e27 .* (x .^ 8) .* (1 - x) ...
    + 0.11079298114176799757e20 / 0.418728168349670240360672963e27 .* (x .^ 9) .* (1 - x) ...
    + 0.40076222660103319736e20 / 0.1256184505049010721082018889e28 .* (x .^ 10) .* (1 - x) ...
    - 0.371450e6 / 0.313853699470081e15 .* (x .^ 11) .* (1 - x);              % Galerkin method n = 10

%% plot
figure('Color',[1 1 1]);
plot(x,u,'r','linewidth',2);
hold on;
plot(x,u1,'b-.','linewidth',2);
plot(x,u2,'m--','linewidth',2);
plot(x,u3,'g-.','linewidth',2);
plot(x,u4,'k--','linewidth',2);
plot(x,u5_1,'b--','linewidth',2);
hold off;
legend('Exact solution','Collocation method',...
    'Sub-domain method','Moment method','Least-Square method','Galerkin method');
grid on;


figure('Color',[1 1 1]);
plot(x,u,'r','linewidth',2);
hold on;
plot(x,u5_1,'b-.','linewidth',2);
plot(x,u5_2,'m--','linewidth',2);
plot(x,u5_3,'g-.','linewidth',2);
plot(x,u5_5,'b--','linewidth',2);
plot(x,u5_8,'y-.','linewidth',2);
plot(x,u5_10,'k--.','linewidth',2);




hold off;
legend('Exact solution','Galerkin method n = 1','Galerkin method n = 2',...
    'Galerkin method n = 3','Galerkin method n = 5',...
    'Galerkin method n = 8','Galerkin method n = 10');
grid on;

%% Program end
